<div #imagesContainer class="images-container" *ngIf="currentPlaces?.length">
  <div class="flex-container column-{{zoom}}"
    infinite-scroll
    [infiniteScrollDistance]="2"
    [infiniteScrollThrottle]="0"
    (scrolled)="onScrollDown()">
    <div #imageContent
         class="image-content"
         *ngFor="let place of placesArr; let i = index"
         [style.-webkit-box-ordinal-group]="i"
         [style.-moz-box-ordinal-group]="i"
         [style.-ms-flex-order]="i"
         [style.-webkit-order]="i"
         [style.order]="i"
         [ngStyle]="{'background-image': place.isUploaded && toUrl(place?.background), height: itemSize + 'px'}"
         [ngClass]="{'no-row': zoom > 5 || !isDesktop, active: prevPlaceId === place._id, 'pin-mode': isPinMode}"
         isImageLoaded [imageLoadedUrl]="place?.background"
         (imageLoadedEvent)="imageIsUploaded(i)"
         (mouseenter)="hoverImage(place)"
         (mouseleave)="hoverImage()"
         (click)="goToImageBlock(place, i)">

      <div class="loader-content" *ngIf="!place.isUploaded">
      <div class="isLoad">
        <div class="la-ball-spin la-dark la-2x">
          <div></div>
          <div></div>
          <div></div>
          <div></div>
          <div></div>
          <div></div>
          <div></div>
          <div></div>
        </div>
      </div>
      </div>

      <div class="image-description">
        <span class="place-image-box-income">${{math.round(place?.income)}}</span>
        <span class="place-image-box-country">{{place?.country}}</span>
      </div>

      <div *ngIf="isPinMode"
            class="heart-container"
            [ngClass]="{'place-pinned': place?.pinned}">
        <div class="heart-circle"
              (click)="addPlaceToSet($event, place)"
              [ngClass]="{'heart-circle-opacity': !place.pinned}">
          <svg *ngIf="!place.pinned" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" id="Capa_1" x="0px" y="0px" width="512px" height="512px" viewBox="0 0 611.993 611.993" style="enable-background:new 0 0 611.993 611.993;" xml:space="preserve">
            <g>
              <path d="M562.519,70.476c-30.272-29.953-73.899-49.155-119.797-49.155c-27.022,0-52.412,6.181-76.823,18.557   C341.48,52.246,321.626,69.17,306,90.657c-15.625-21.487-35.481-38.411-59.898-50.78c-24.418-12.375-49.808-18.557-76.823-18.557   c-45.898,0-89.518,19.203-119.797,49.155C19.209,100.422,0,144.042,0,189.947c0,31.571,6.708,62.218,14.973,85.289   c4.104,11.438,10.306,23.834,18.556,36.46c8.348,12.771,15.952,23.438,22.459,31.896c6.514,8.467,15.792,19.049,28.321,31.252   c12.535,12.215,22.786,21.812,30.272,28.646c7.486,6.842,18.876,16.939,33.856,29.953c17.244,14.98,29.543,26.133,37.439,33.203   c7.729,6.924,18.883,17.576,33.529,31.578c29.626,28.312,51.363,54.404,71.941,84.309c3.84,5.584,8.792,8.139,14.646,8.139   c6.188,0,11.542-2.5,15.299-8.139c13.175-19.758,28.404-39.967,46.225-59.898c17.987-20.111,32.96-35.717,44.926-46.877   c12.126-11.307,29.557-27.084,52.086-47.197c13.931-12.445,25.063-21.812,32.557-28.646c7.486-6.84,17.251-16.279,29.3-28.32   c12.043-12.049,21.563-22.404,28.321-30.932c6.917-8.723,14.223-19.273,22.459-31.898c16.827-25.786,24.195-46.203,30.272-74.871   c3.027-14.306,4.556-28.974,4.556-43.946C612,144.042,592.791,100.422,562.519,70.476z M572.936,223.149   c-6.271,36.12-25.14,71.545-56.642,106.449c-13.75,15.23-38.987,39.475-75.851,72.268c-19.126,17.016-34.501,30.932-46.551,41.996   c-11.716,10.75-26.126,25.307-43.293,43.619c-17.015,18.146-31.904,36.133-44.6,53.711c-13.348-17.25-28.73-34.752-46.224-52.738   c-17.661-18.146-31.251-31.898-41.342-41.016c-10.091-9.111-25.466-22.703-46.551-41.342l-22.459-19.855l-20.508-18.557   c-8.882-8.035-15.716-14.57-20.182-19.529c-4.319-4.805-10.09-11.07-17.25-18.883s-12.667-14.666-16.279-20.182   c-7.458-11.41-20.14-28.438-24.737-42.647l-7.487-23.112c-5.458-16.848-7.16-34.182-7.16-53.384   c0-36.46,13.021-67.711,39.064-93.428c26.369-26.042,57.621-39.064,94.4-39.064c25.716,0,49.481,6.833,71.295,20.834   c21.813,13.993,38.626,32.446,49.481,55.662c3.146,6.736,8.466,10.091,15.952,10.091s13.271-3.125,16.605-10.091   c10.993-22.994,26.695-41.669,48.502-55.662c21.807-14.001,45.897-20.834,71.614-20.834c36.786,0,68.038,13.021,94.081,38.738   s39.063,56.968,39.063,93.754C575.866,201.336,574.804,212.392,572.936,223.149z" fill="#364551"/>
            </g>
          </svg>

          <svg *ngIf="place.pinned"  version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
                viewBox="0 0 50 50" style="enable-background:new 0 0 50 50;" xml:space="preserve">
            <path style="fill:#D75A4A;" d="M24.85,10.126c2.018-4.783,6.628-8.125,11.99-8.125c7.223,0,12.425,6.179,13.079,13.543
              c0,0,0.353,1.828-0.424,5.119c-1.058,4.482-3.545,8.464-6.898,11.503L24.85,48L7.402,32.165c-3.353-3.038-5.84-7.021-6.898-11.503
              c-0.777-3.291-0.424-5.119-0.424-5.119C0.734,8.179,5.936,2,13.159,2C18.522,2,22.832,5.343,24.85,10.126z"/>
         </svg>
        </div>
      </div>
    </div>

    <matrix-view-block class="matrix-view-block"
                       *ngIf="showBlock"
                       [itemSize]="itemSize"
                       [query]="query"
                       [place]="familyData"
                       [thing]="thing"
                       [positionInRow]="positionInRow"
                       [style.-webkit-box-ordinal-group]="imageBlockLocation"
                       [style.-moz-box-ordinal-group]="imageBlockLocation"
                       [style.-ms-flex-order]="imageBlockLocation"
                       [style.-webkit-order]="imageBlockLocation"
                       [style.order]="imageBlockLocation"
                       (goToMatrixWithCountry)="goToMatrixWithCountry($event)"
                       (closeBigImageBlock)="goToImageBlock(familyData, indexViewBoxHouse)">
    </matrix-view-block>
  </div>
</div>

<div class="xl-text-c" *ngIf="showErrorMsg">
  <p>{{errorMsg}}</p>
</div>
